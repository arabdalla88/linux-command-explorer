#!/bin/bash

# ุงุณู ุงูุฃูุฑ ุงููู ููุชุดุฑุญ
COMMAND=$1

# ูุนุฑูุฉ ููุงู ุงูุณูุฑูุจุช ููุณู
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# ุชุญุฏูุฏ ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุงุกู ุนูู ููุงู ุงูุณูุฑูุจุช
DB_FILE="$SCRIPT_DIR/commands-db.txt"

# ุงูุชุญูู ูู ุฅุฏุฎุงู ุงูุฃูุฑ
if [[ -z "$COMMAND" ]]; then
  echo "โ ูู ูุถูู ุฃุฏุฎู ุฃูุฑ ููููุณ ุชุฑูุฏ ุดุฑุญู"
  echo "ูุซุงู: explore ls"
  exit 1
fi

# ุงูุชุญูู ูู ูุฌูุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
if [[ ! -f "$DB_FILE" ]]; then
  echo "โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ููุฌูุฏุฉ ูู ููุณ ูุฌูุฏ ุงูุณูุฑูุจุช: $DB_FILE"
  exit 1
fi

# ุงูุชุญูู ูู ูุฌูุฏ ุงูุฃูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
if ! grep -q "^:$COMMAND" "$DB_FILE"; then
  echo "โ ุงูุฃูุฑ '$COMMAND' ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช."
  echo "๐ฏ ููููู ุทูุจ ุฅุถุงูุชู ูุงุญููุง."
  exit 1
fi

# ุทุจุงุนุฉ ุดุฑุญ ุงูุฃูุฑ
awk -v cmd=":$COMMAND" '
  trim($0) == cmd {flag=1; next}
  /^:/ && flag {exit}
  flag

function trim(s) {
  gsub(/^[ \t\r\n]+|[ \t\r\n]+$/, "", s)
  return s
}
' "$DB_FILE"
